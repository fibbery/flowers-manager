# 🏡 花坊管理 - 使用说明

## ✨ 功能概述

花坊管理系统支持批量录入花朵名单，自动对比显示待分配的花朵，并可查看每朵花的拥有者。

---

## 🎯 核心功能

### 1. 📝 批量录入
用逗号分隔，一次录入多个花名：
```
玫瑰,百合,栀子花,太阳花,菊花,康乃馨,郁金香,牡丹,茉莉花,桂花
```

### 2. 🔍 智能对比
自动对比花坊名单和所有人拥有的花，显示：
- ❌ 待分配 - 花坊有但无人拥有
- ✅ 已分配 - 至少一人拥有

### 3. 👥 查看拥有者
点击已分配花朵的"✓ X人"按钮，弹窗显示完整拥有者列表。

### 4. 📊 实时统计
- 花坊总数
- 已分配数量
- 待分配数量
- 分配率百分比

---

## 🎨 界面布局

```
🏡 花坊管理

┌─ 📝 花坊名单  [✏️编辑名单] ─┐
│ [文本域：逗号分隔花名]       │
│ [💾 保存] [取消]            │
└──────────────────────────────┘
        ↓
┌─ ❌ 待分配 (共3种) ─────────┐
│ 🌺 栀子花  🌺 郁金香        │
└──────────────────────────────┘
        ↓
┌─ ✅ 已分配 (共7种) ─────────┐
│ 🌺 玫瑰 [✓ 3人] ← 点击查看  │
└──────────────────────────────┘
        ↓
┌─ 📊 统计信息 ───────────────┐
│ 总数:10 已:7 待:3 率:70%   │
└──────────────────────────────┘
```

---

## 💡 使用流程

### 首次使用

**步骤 1：录入花坊名单**
```
1. 进入"🏡 花坊管理"Tab
2. 文本域中输入花名（逗号分隔）
   例如：玫瑰,百合,栀子花,太阳花,菊花
3. 点击"💾 保存花坊名单"
4. Toast提示"花坊名单保存成功！"
5. 文本域变为只读（灰色背景）
```

**步骤 2：查看对比结果**
```
保存后自动显示：
- ❌ 待分配的花朵（红色区域）
- ✅ 已分配的花朵（绿色区域）
- 📊 统计信息
```

**步骤 3：给人员分配花朵**
```
1. 切换到其他Tab
2. 给人员添加花朵
3. 回到花坊管理
4. 待分配数量减少
```

**步骤 4：查看拥有者**
```
1. 在"已分配"区域
2. 点击"✓ X人"按钮
3. 弹窗显示所有拥有者
```

### 编辑名单

**步骤 1：解锁编辑**
```
1. 点击"✏️ 编辑名单"按钮
2. 文本域解锁（白色背景）
3. 显示"保存"和"取消"按钮
```

**步骤 2：修改内容**
```
1. 修改花名列表
2. 点击"💾 保存" → 保存并锁定
   或点击"取消" → 恢复原内容并锁定
```

---

## 📊 对比示例

### 示例数据

**花坊名单：**
```
玫瑰,百合,栀子花,太阳花,菊花
```

**人员拥有：**
```
李鑫：玫瑰, 百合
王五：玫瑰
张三：菊花
```

**对比结果：**
```
所有人拥有（去重）= {玫瑰, 百合, 菊花}

❌ 待分配 = 花坊 - 已拥有
          = {玫瑰, 百合, 栀子花, 太阳花, 菊花} - {玫瑰, 百合, 菊花}
          = {栀子花, 太阳花}

✅ 已分配 = 花坊 ∩ 已拥有
          = {玫瑰, 百合, 菊花}

📊 统计：
  - 花坊总数：5
  - 已分配：3（玫瑰、百合、菊花）
  - 待分配：2（栀子花、太阳花）
  - 分配率：60%
```

---

## 🔄 编辑/只读模式

### 只读模式（保存后）
```
┌─ 📝 花坊名单  [✏️编辑名单] ─┐
│                              │
│ 玫瑰,百合,栀子花...（灰色） │ ← 不可编辑
│                              │
│ （无按钮）                   │
└──────────────────────────────┘
```

### 编辑模式（点击编辑后）
```
┌─ 📝 花坊名单 ────────────────┐
│                              │
│ 玫瑰,百合,栀子花...（白色） │ ← 可编辑
│                              │
│ [💾 保存] [取消]            │
└──────────────────────────────┘
```

---

## 👥 查看拥有者功能

### 使用方式

点击已分配区域的花朵徽章：
```
✅ 已分配的花朵

🌺 玫瑰  [✓ 3人] ← 点击
  ↓
┌─ 🌺 玫瑰 的拥有者 ─┐
│ 👤 李鑫            │
│ 👤 王五            │
│ 👤 张三            │
└────────────────────┘
```

### 弹窗特性
- 小窗口展示（400px）
- 列表清晰易读
- 悬停高亮效果
- 点击遮罩或✕关闭

---

## 📱 移动端适配

- ✅ 文本域全宽显示
- ✅ 统计信息2x2网格
- ✅ 待分配/已分配单列显示
- ✅ 所有卡片自适应

---

## 🚀 部署更新

```bash
# 上传文件
scp backend/server-prod.js backend/server.js \
  root@your-server:/root/flowers-manager/backend/
scp -r backend/public/* \
  root@your-server:/root/flowers-manager/backend/public/

# 重启服务
ssh root@your-server
pm2 restart flowers-manager
```

---

## ✅ 快速开始

```
1. 进入花坊管理
2. 输入花名：玫瑰,百合,栀子花,太阳花,菊花
3. 保存
4. 给人员分配花朵
5. 回到花坊查看：
   - 待分配列表（红色）
   - 已分配列表（绿色）
   - 点击"✓ X人"查看拥有者
6. 需要修改时点击"编辑名单"
```

---

## 🎉 功能总结

**核心价值：**
- ⚡ 批量录入 - 一次录入多个花名
- 🔍 智能对比 - 自动显示待分配
- 👥 拥有者查看 - 点击查看完整列表
- 📊 实时统计 - 分配进度一目了然
- ✏️ 编辑模式 - 保存后锁定，防误操作

**使用简单：**
- 录入 → 保存 → 查看对比 → 分配花朵
- 需要修改 → 点击编辑 → 修改 → 保存

---

现在花坊管理更加简洁易用了！🌸

**部署后记得清除浏览器缓存！** ✨

